# YouTube Video Integration Setup Guide

## Overview
The MindSphere application now automatically fetches YouTube videos related to lesson topics and displays them in the lesson viewer.

## Features
‚úÖ Automatic YouTube video search based on lesson titles and course topics
‚úÖ Displays educational, high-definition videos with closed captions preference
‚úÖ Embedded YouTube player with full controls
‚úÖ Fallback to placeholder if no videos found
‚úÖ Graceful degradation if API key not configured

## Setup Instructions

### Step 1: Get a YouTube API Key

1. Go to [Google Cloud Console](https://console.cloud.google.com/)
2. Create a new project or select an existing one
3. Enable the **YouTube Data API v3**:
   - Go to "APIs & Services" ‚Üí "Library"
   - Search for "YouTube Data API v3"
   - Click on it and press "Enable"
4. Create OAuth 2.0 credentials:
   - Go to "APIs & Services" ‚Üí "Credentials"
   - Click "Create Credentials" ‚Üí "API Key"
   - Copy the API key

### Step 2: Add the API Key to Environment Variables

1. Open `server/.env`
2. Add your YouTube API key:
   ```
   YOUTUBE_API_KEY=your_youtube_api_key_here
   ```
3. Save the file

### Step 3: Restart the Server

```bash
# Stop the running server (Ctrl+C)
# Restart it
npm run dev
```

## How It Works

### When Creating a Course:
1. Course content is generated by Gemini AI
2. Lessons are created with titles and descriptions
3. For each lesson, the system searches YouTube for:
   - Videos matching "{lesson_title} {course_topic} tutorial educational"
   - Filters for HD videos with closed captions preference
4. The best matching video is selected and embedded
5. The video URL is stored in the lesson object

### Video Display:
- YouTube videos are embedded using iframe
- Videos are responsive and maintain aspect ratio
- Full YouTube player controls are available
- Videos can be fullscreened

## YouTube API Search Strategy

The search algorithm:
1. **Primary search**: Uses both lesson title and course topic
   - Query: `"{lessonTitle} {courseTopic} tutorial educational"`
   - Results: Sorted by relevance
   - Preferences: HD quality, closed captions

2. **Fallback search** (if no results):
   - Query: `"{lessonTitle} tutorial educational"`
   - This ensures almost all lessons get a video

3. **No video fallback**:
   - If no videos found, displays placeholder message
   - Lesson content is still fully accessible
   - User can proceed with text-based learning

## Search Parameters

The search filters for:
- **Type**: Video only (no playlists or channels)
- **Quality**: HD definition
- **Captions**: Preference for closed captions
- **Results**: Top 1 result per lesson
- **Order**: Relevance

## Cost Considerations

YouTube Data API v3 Free Tier:
- 10,000 quota units per day (shared across all API calls)
- Each search = 100 quota units
- Means: ~100 searches per day included free

For production use:
- Monitor API quota in Google Cloud Console
- Consider implementing caching of video URLs
- Set up billing alerts if needed

## Troubleshooting

### Videos not showing up?

1. **Check API key is set**:
   ```bash
   echo $YOUTUBE_API_KEY  # Linux/Mac
   # or check in server/.env file
   ```

2. **Check server logs** for:
   - `üîç Searching YouTube for:` - Search was attempted
   - `‚ùå Error searching YouTube:` - API error occurred
   - `‚úÖ Found X videos` - Videos were found

3. **Common errors**:
   - `401 Unauthorized` ‚Üí API key is invalid
   - `403 Forbidden` ‚Üí API key doesn't have YouTube Data API v3 permission
   - `400 Bad Request` ‚Üí Search query issue (check lesson titles)

4. **Verify YouTube API is enabled**:
   - Go to [Google Cloud Console](https://console.cloud.google.com/)
   - Select your project
   - Check "APIs & Services" ‚Üí "Enabled APIs & services"
   - Verify "YouTube Data API v3" is listed

### Videos loading slowly?

- YouTube API search adds ~1-3 seconds per lesson
- Consider implementing async loading/caching
- Contact support if consistently slow

## Environment Variables

```env
# Optional YouTube Data API Configuration
# Leave empty to disable YouTube video integration
YOUTUBE_API_KEY=AIzaSy... (your API key)
```

## API Limits and Best Practices

### Rate Limits:
- 10,000 quota units per day (free)
- Each search costs 100 units
- = 100 free searches per day

### Best Practices:
1. **Cache results**: Don't re-search for same topic multiple times
2. **Batch searches**: Search during off-peak hours
3. **Error handling**: Gracefully handle missing videos
4. **Monitor quota**: Check dashboard regularly
5. **Testing**: Use realistic lesson titles for testing

## Disabling YouTube Videos

If you want to disable YouTube video fetching:
- Leave `YOUTUBE_API_KEY` empty in `.env`
- The system will continue to work without videos
- Lesson content remains fully accessible

## Future Enhancements

Potential improvements:
- Cache video URLs in database to reduce API calls
- Allow users to switch between different videos for a lesson
- Add video transcripts to lesson content
- Implement video playlist features
- Add video quality selection

## Support

For issues or questions:
1. Check the troubleshooting section above
2. Review server logs for error messages
3. Verify YouTube API key validity
4. Check Google Cloud Console for quota usage
